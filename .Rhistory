rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
remote_wrk=`Do you work remotely (outside of an office) at least 50% of the time?`,
id=UserID)
#For consistency purposes, only keep those that identified as Male or Female
df.2014<-df.2014 %>%
filter(str_detect(gender, pattern = "[Male]|[Female]"))
#Pivot the columns longer and rename them
df.2014<-df.2014%>%
pivot_wider(names_from = question,
values_from = answer)
df.2014<-df.2014%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
remote_wrk=`Do you work remotely (outside of an office) at least 50% of the time?`,
id=UserID)
#For consistency purposes, only keep those that identified as Male or Female
df.2014<-df.2014 %>%
filter(gender=="Male")
#Pivot the columns longer and rename them
df.2014<-df.2014%>%
pivot_wider(names_from = question,
values_from = answer)
df.2014<-df.2014%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
remote_wrk=`Do you work remotely (outside of an office) at least 50% of the time?`,
id=UserID)
#For consistency purposes, only keep those that identified as Male or Female
df.2014<-df.2014 %>%
filter(gender=="Male"|gender=="Female")
View(df.2014)
#For consistency purposes, only keep those that identified as Male or Female
df.2014<-df.2014 %>%
filter(gender=="Male"|gender=="Female")%>%
factor(gender)
df.2014$gender<-factor(df.2014$gender)
plot_bar(df.2014, maxcat = 5, ggtheme = theme_bw())
plot_bar(df.2014, maxcat = 5, by="gender", ggtheme = theme_bw())
plot_correlation(df.2014)
plot_bar(df.2014, maxcat = 5, by="gender", ggtheme = theme_bw())
#Explore data
plot_intro(df.2014)
#Explore data
plot_intro(df.2014, ggtheme = theme_bw())
plot_bar(df.2014, maxcat = 5, by="gender", ggtheme = theme_bw())
library(tidyverse)
library(DBI)
library(RSQLite)
library(ggplot2)
library(plotly)
library(lubridate)
library(ggcorrplot)
library(DataExplorer)
conn<-dbConnect(SQLite(), "mental_health.sqlite")
tables <- dbListTables(conn)
#Pivot the columns longer and rename them
df.2014<-df.2014%>%
pivot_wider(names_from = question,
values_from = answer)
df.2014<-df.2014%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
diagnose=`Have you ever sought treatment for a mental health disorder from a mental health professional?`,
remote_wrk=`Do you work remotely (outside of an office) at least 50% of the time?`,
id=UserID)
df.2016<-df.2016%>%
pivot_wider(names_from = question,
values_from = answer)
df.2016<-df.2016%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
diagnose=`Have you ever been diagnosed with a mental health disorder?`,
remote_wrk=`Do you work remotely?`,
id=UserID,
position=`Which of the following best describes your work position?`)
df.2017<-df.2017%>%
pivot_wider(names_from = question,
values_from = answer)
df.2017<-df.2017%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
diagnose= `Are you openly identified at work as a person with a mental health issue?`,
race=`What is your race?`,
id=UserID)
#For consistency purposes, only keep those that identified as Male or Female
df.2014<-df.2014 %>%
filter(gender=="Male"|gender=="Female")
df.2014$gender<-factor(df.2014$gender)
#str(df.2016)
#Some of the columns are lists, unlist them
df.2016$age<-unlist(df.2016$age)
df.2016$gender<-unlist(df.2016$gender)
df.2016$location<-unlist(df.2016$location)
df.2016$fam_history_MI<-unlist(df.2016$fam_history_MI)
df.2016$diagnose<-unlist(df.2016$diagnose)
df.2016$remote_wrk<-unlist(df.2016$remote_wrk)
#Regex to help clean the position column
df.2016$position<-str_replace_all(df.2016$position,'[^A-Za-z0-9 ]',"")
df.2016<-df.2016 %>%
filter(gender=="Male"|gender=="Female")
df.2016$gender<-factor(df.2016$gender)
##For the 2017 dataset, the race column has numeric
#For consistency, we can recode it or remove it
df.2017<-df.2017%>%
mutate(race=ifelse(race=="-1", "unidentified",
ifelse(race=="More than one of the above", "Multiracial", race)))
df.2017<-df.2017 %>%
filter(gender=="Male"|gender=="Female")
df.2017$gender<-factor(df.2017$gender)
#Keep only locations with more than 20 observations in each of the survey years
country<-c("Australia", "Canada", "Germany", "Netherlands",
"United Kingdom", "United States")
df.2014<-df.2014%>%
filter(location %in% country)
country<-c("Australia", "Canada", "Germany", "Netherlands",
"United Kingdom", "United States of America")
df.2016<-df.2016%>%
filter(location %in% country)
df.2017<-df.2017%>%
filter(location %in% country)
#Explore data
plot_intro(df.2014, ggtheme = theme_bw())
plot_bar(df.2014, maxcat = 5, by="gender",
ggtheme = theme_bw(),
title = "2014 Respondents")
plot_bar(df.2016, maxcat = 5, by="gender",
ggtheme = theme_bw(), ncol = 2,
title = "2016 Respondents")
plot_bar(df.2017, maxcat = 8, by="gender",
ggtheme = theme_bw(), nrow = 3,
title = "2017 Respondents")
View(df.2017)
##For the 2017 dataset, the race column has numeric
#For consistency, we can recode it or remove it
df.2017<-df.2017%>%
mutate(race=ifelse(race=="-1" || race=="I prefer not to answer", "unidentified",
ifelse(race=="More than one of the above", "Multiracial", race)))
df.2017<-df.2017%>%
pivot_wider(names_from = question,
values_from = answer)
df.2017<-df.2017%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
diagnose= `Are you openly identified at work as a person with a mental health issue?`,
race=`What is your race?`,
id=UserID)
##For the 2017 dataset, the race column has numeric
#For consistency, we can recode it or remove it
df.2017<-df.2017%>%
mutate(race=ifelse(race=="-1" || race=="I prefer not to answer", "unidentified",
ifelse(race=="More than one of the above", "Multiracial", race)))
df.2017<-df.2017%>%
pivot_wider(names_from = question,
values_from = answer)
df.2017<-df.2017%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
diagnose= `Are you openly identified at work as a person with a mental health issue?`,
race=`What is your race?`,
id=UserID)
##For the 2017 dataset, the race column has numeric
#For consistency, we can recode it or remove it
df.2017<-df.2017%>%
mutate(race=ifelse(race=="-1", "unidentified",
ifelse(race=="More than one of the above", "Multiracial",
ifesle(race=="I prefer not to answer", "unidentified" , race))))
##For the 2017 dataset, the race column has numeric
#For consistency, we can recode it or remove it
df.2017<-df.2017%>%
mutate(race=ifelse(race=="-1", "Unidentified",
ifelse(race=="More than one of the above", "Multiracial",
ifesle(race=="I prefer not to answer", "Unidentified", race))))
##For the 2017 dataset, the race column has numeric
#For consistency, we can recode it or remove it
df.2017<-df.2017%>%
mutate(race=ifelse(race=="-1", "Unidentified",
ifelse(race=="More than one of the above", "Multiracial",
ifelse(race=="I prefer not to answer", "Unidentified", race))))
#Pivot the columns longer and rename them
df.2014<-df.2014%>%
pivot_wider(names_from = question,
values_from = answer)
df.2014<-df.2014%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
diagnose=`Have you ever sought treatment for a mental health disorder from a mental health professional?`,
remote_wrk=`Do you work remotely (outside of an office) at least 50% of the time?`,
id=UserID)
df.2016<-df.2016%>%
pivot_wider(names_from = question,
values_from = answer)
df.2016<-df.2016%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
diagnose=`Have you ever been diagnosed with a mental health disorder?`,
remote_wrk=`Do you work remotely?`,
id=UserID,
position=`Which of the following best describes your work position?`)
df.2017<-df.2017%>%
pivot_wider(names_from = question,
values_from = answer)
df.2017<-df.2017%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
diagnose= `Are you openly identified at work as a person with a mental health issue?`,
race=`What is your race?`,
id=UserID)
#For consistency purposes, only keep those that identified as Male or Female
df.2014<-df.2014 %>%
filter(gender=="Male"|gender=="Female")
df.2014$gender<-factor(df.2014$gender)
#str(df.2016)
#Some of the columns are lists, unlist them
df.2016$age<-unlist(df.2016$age)
df.2016$gender<-unlist(df.2016$gender)
df.2016$location<-unlist(df.2016$location)
df.2016$fam_history_MI<-unlist(df.2016$fam_history_MI)
df.2016$diagnose<-unlist(df.2016$diagnose)
df.2016$remote_wrk<-unlist(df.2016$remote_wrk)
#Regex to help clean the position column
df.2016$position<-str_replace_all(df.2016$position,'[^A-Za-z0-9 ]',"")
df.2016<-df.2016 %>%
filter(gender=="Male"|gender=="Female")
df.2016$gender<-factor(df.2016$gender)
##For the 2017 dataset, the race column has numeric
#For consistency, we can recode it or remove it
df.2017<-df.2017%>%
mutate(race=ifelse(race=="-1", "Unidentified",
ifelse(race=="More than one of the above", "Multiracial",
ifelse(race=="I prefer not to answer", "Unidentified", race))))
df.2017<-df.2017 %>%
filter(gender=="Male"|gender=="Female")
df.2017$gender<-factor(df.2017$gender)
#Keep only locations with more than 20 observations in each of the survey years
country<-c("Australia", "Canada", "Germany", "Netherlands",
"United Kingdom", "United States")
df.2014<-df.2014%>%
filter(location %in% country)
country<-c("Australia", "Canada", "Germany", "Netherlands",
"United Kingdom", "United States of America")
df.2016<-df.2016%>%
filter(location %in% country)
df.2017<-df.2017%>%
filter(location %in% country)
#Explore data
plot_intro(df.2014, ggtheme = theme_bw())
plot_bar(df.2014, maxcat = 5, by="gender",
ggtheme = theme_bw(),
title = "2014 Respondents")
plot_bar(df.2016, maxcat = 5, by="gender",
ggtheme = theme_bw(), ncol = 2,
title = "2016 Respondents")
plot_bar(df.2017, maxcat = 8, by="gender",
ggtheme = theme_bw(), nrow = 3,
title = "2017 Respondents")
plot_bar(df.2017, maxcat = 5, by="gender",
ggtheme = theme_bw(), nrow = 3,
title = "2017 Respondents")
plot_bar(df.2017, maxcat = 5, by="gender",
ggtheme = theme_bw(), ncol = 2,
title = "2017 Respondents")
View(df.2016)
View(df.2014)
#Chi-tests
##2014
table(df.2014$diagnose, df.2014$gender)
plot_bar(df.2014, maxcat = 5, by="gender",
ggtheme = theme_bw(),
title = "2014 Respondents")
#Pivot the columns longer and rename them
df.2014<-df.2014%>%
pivot_wider(names_from = question,
values_from = answer)
df.2014<-df.2014%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
diagnose=`Have you ever sought treatment for a mental health disorder from a mental health professional?`,
remote_wrk=`Do you work remotely (outside of an office) at least 50% of the time?`,
id=UserID)
#For consistency purposes, only keep those that identified as Male or Female
df.2014<-df.2014 %>%
filter(gender=="Male"|gender=="Female")%>%
mutate(diagnose= ifelse(diagnose==1, "Yes", "No"))
df.2014$gender<-factor(df.2014$gender)
df.2014$diagnose<-factor(df.2014$diagnose)
#Explore data
plot_intro(df.2014, ggtheme = theme_bw())
plot_bar(df.2014, maxcat = 5, by="gender",
ggtheme = theme_bw(),
title = "2014 Respondents")
plot_bar(df.2014, maxcat = 5, by="gender",
ggtheme = theme_bw(), ncol = 2,
title = "2014 Respondents")
#Chi-tests
##2014
table(df.2014$diagnose, df.2014$gender)
#Chi-tests
##2014
chisq.test(table(df.2014$diagnose, df.2014$gender))
plot_bar(df.2016, maxcat = 5, by="gender",
ggtheme = theme_bw(), ncol = 2,
title = "2016 Respondents")
chisq.test(table(df.2016$diagnose, df.2016$gender))
plot_bar(df.2017, maxcat = 5, by="gender",
ggtheme = theme_bw(), ncol = 2,
title = "2017 Respondents")
df.2017<-df.2017%>%
pivot_wider(names_from = question,
values_from = answer)
df.2017<-df.2017%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
diagnose= `Are you openly identified at work as a person with a mental health issue?`,
race=`What is your race?`,
id=UserID)
##For the 2017 dataset, the race column has numeric
#For consistency, we can recode it or remove it
df.2017<-df.2017%>%
mutate(race=ifelse(race=="-1", "Unidentified",
ifelse(race=="More than one of the above", "Multiracial",
ifelse(race=="I prefer not to answer", "Unidentified", race))))
df.2017<-df.2017 %>%
filter(gender=="Male"|gender=="Female")%>%
mutate(diagnose= ifelse(diagnose==1, "Yes", "No"))
df.2017$gender<-factor(df.2017$gender)
df.2017$diagnose<-factor(df.2017$diagnose)
df.2017<-df.2017%>%
filter(location %in% country)
plot_bar(df.2017, maxcat = 5, by="gender",
ggtheme = theme_bw(), ncol = 2,
title = "2017 Respondents")
chisq.test(table(df.2017$diagnose, df.2017$gender))
table(df.2017$diagnose, df.2017$gender)
chisq.test(table(df.2017$diagnose, df.2017$gender))
#Pivot the columns longer and rename them
df.2014<-df.2014%>%
pivot_wider(names_from = question,
values_from = answer)
df.2014<-df.2014%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
diagnose=`Have you ever sought treatment for a mental health disorder from a mental health professional?`,
remote_wrk=`Do you work remotely (outside of an office) at least 50% of the time?`,
id=UserID)
df.2016<-df.2016%>%
pivot_wider(names_from = question,
values_from = answer)
df.2016<-df.2016%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
diagnose=`Have you ever been diagnosed with a mental health disorder?`,
remote_wrk=`Do you work remotely?`,
id=UserID,
position=`Which of the following best describes your work position?`)
df.2017<-df.2017%>%
pivot_wider(names_from = question,
values_from = answer)
df.2017<-df.2017%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
diagnose= `Are you openly identified at work as a person with a mental health issue?`,
race=`What is your race?`,
id=UserID)
#For consistency purposes, only keep those that identified as Male or Female
df.2014<-df.2014 %>%
filter(gender=="Male"|gender=="Female")%>%
mutate(diagnose= ifelse(diagnose==1, "Yes", "No"))
df.2014$gender<-factor(df.2014$gender)
df.2014$diagnose<-factor(df.2014$diagnose)
#str(df.2016)
#Some of the columns are lists, unlist them
df.2016$age<-unlist(df.2016$age)
df.2016$gender<-unlist(df.2016$gender)
df.2016$location<-unlist(df.2016$location)
df.2016$fam_history_MI<-unlist(df.2016$fam_history_MI)
df.2016$diagnose<-unlist(df.2016$diagnose)
df.2016$remote_wrk<-unlist(df.2016$remote_wrk)
#Regex to help clean the position column
df.2016$position<-str_replace_all(df.2016$position,'[^A-Za-z0-9 ]',"")
df.2016<-df.2016 %>%
filter(gender=="Male"|gender=="Female")
df.2016$gender<-factor(df.2016$gender)
##For the 2017 dataset, the race column has numeric
#For consistency, we can recode it or remove it
df.2017<-df.2017%>%
mutate(race=ifelse(race=="-1", "Unidentified",
ifelse(race=="More than one of the above", "Multiracial",
ifelse(race=="I prefer not to answer", "Unidentified", race))))
df.2017<-df.2017 %>%
filter(gender=="Male"|gender=="Female")%>%
mutate(diagnose= ifelse(diagnose==1, "Yes", "No"))
df.2017$gender<-factor(df.2017$gender)
df.2017$diagnose<-factor(df.2017$diagnose)
#Keep only locations with more than 20 observations in each of the survey years
country<-c("Australia", "Canada", "Germany", "Netherlands",
"United Kingdom", "United States")
df.2014<-df.2014%>%
filter(location %in% country)
country<-c("Australia", "Canada", "Germany", "Netherlands",
"United Kingdom", "United States of America")
df.2016<-df.2016%>%
filter(location %in% country)
df.2017<-df.2017%>%
filter(location %in% country)
#Explore data
plot_intro(df.2014, ggtheme = theme_bw())
plot_bar(df.2014, maxcat = 5, by="gender",
ggtheme = theme_bw(), ncol = 2,
title = "2014 Respondents")
plot_bar(df.2016, maxcat = 5, by="gender",
ggtheme = theme_bw(), ncol = 2,
title = "2016 Respondents")
plot_bar(df.2017, maxcat = 5, by="gender",
ggtheme = theme_bw(), ncol = 2,
title = "2017 Respondents")
chisq.test(table(df.2017$diagnose, df.2017$gender))
df.2017<-df.2017%>%
pivot_wider(names_from = question,
values_from = answer)
df.2017<-df.2017%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
diagnose= `Are you openly identified at work as a person with a mental health issue?`,
race=`What is your race?`,
id=UserID)
##For the 2017 dataset, the race column has numeric
#For consistency, we can recode it or remove it
df.2017<-df.2017%>%
mutate(race=ifelse(race=="-1", "Unidentified",
ifelse(race=="More than one of the above", "Multiracial",
ifelse(race=="I prefer not to answer", "Unidentified", race))))
df.2017<-df.2017 %>%
filter(gender=="Male"|gender=="Female")%>%
mutate(diagnose= ifelse(diagnose==1, "Yes", "No"))
chisq.test(table(df.2017$diagnose, df.2017$gender))
df.2017<-df.2017%>%
pivot_wider(names_from = question,
values_from = answer)
df.2017<-df.2017%>%
rename(age=`What is your age?`,
location=`What country do you live in?`,
gender=`What is your gender?`,
fam_history_MI=`Do you have a family history of mental illness?`,
diagnose= `Are you openly identified at work as a person with a mental health issue?`,
race=`What is your race?`,
id=UserID)
##For the 2017 dataset, the race column has numeric
#For consistency, we can recode it or remove it
df.2017<-df.2017%>%
mutate(race=ifelse(race=="-1", "Unidentified",
ifelse(race=="More than one of the above", "Multiracial",
ifelse(race=="I prefer not to answer", "Unidentified", race))))
df.2017<-df.2017 %>%
filter(gender=="Male"|gender=="Female")%>%
mutate(diagnose= ifelse(diagnose==1, "Yes", "No"))
df.2017$gender<-factor(df.2017$gender)
df.2017$diagnose<-factor(df.2017$diagnose)
df.2017<-df.2017%>%
filter(location %in% country)
plot_bar(df.2014, maxcat = 5, by="gender",
ggtheme = theme_bw(), ncol = 2,
title = "2014 Respondents")
plot_bar(df.2016, maxcat = 5, by="gender",
ggtheme = theme_bw(), ncol = 2,
title = "2016 Respondents")
plot_bar(df.2017, maxcat = 5, by="gender",
ggtheme = theme_bw(), ncol = 2,
title = "2017 Respondents")
##Family history
chisq.test(table(df.2014$diagnose, df.2014$fam_history_MI))
#Chi-tests
##Gender
chisq.test(table(df.2014$diagnose, df.2014$gender))
##Family history
chisq.test(table(df.2014$diagnose, df.2014$fam_history_MI))
chisq.test(table(df.2016$diagnose, df.2016$fam_history_MI))
chisq.test(table(df.2017$diagnose, df.2017$fam_history_MI))
